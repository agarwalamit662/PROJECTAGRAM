<html><head><link rel="prefetch" href="lazy-resources.html"><link rel="prefetch" href="shop-404-warning.html"></head><body><div hidden="" by-polymer-bundler=""><link rel="import" href="shop-app.html"><script>Polymer.IronRangeBehavior={properties:{value:{type:Number,value:0,notify:!0,reflectToAttribute:!0},min:{type:Number,value:0,notify:!0},max:{type:Number,value:100,notify:!0},step:{type:Number,value:1,notify:!0},ratio:{type:Number,value:0,readOnly:!0,notify:!0}},observers:['_update(value, min, max, step)'],_calcRatio:function(b){return(this._clampValue(b)-this.min)/(this.max-this.min)},_clampValue:function(b){return Math.min(this.max,Math.max(this.min,this._calcStep(b)))},_calcStep:function(b){if(b=parseFloat(b),!this.step)return b;var c=Math.round((b-this.min)/this.step);return 1>this.step?c/(1/this.step)+this.min:c*this.step+this.min},_validateValue:function(){var b=this._clampValue(this.value);return this.value=this.oldValue=isNaN(b)?this.oldValue:b,this.value!==b},_update:function(){this._validateValue(),this._setRatio(100*this._calcRatio(this.value))}};</script><dom-module id="paper-progress" assetpath="../bower_components/paper-progress/"><template><style>:host{display:block;width:200px;position:relative;overflow:hidden;}:host([hidden]){display:none !important;}#progressContainer{@apply (--paper-progress-container);position:relative;}#progressContainer,
      /* the stripe for the indeterminate animation*/
      .indeterminate::after{height:var(--paper-progress-height, 4px);}#primaryProgress,
      #secondaryProgress,
      .indeterminate::after{@apply (--layout-fit);}#progressContainer,
      .indeterminate::after{background:var(--paper-progress-container-color, --google-grey-300);}:host(.transiting) #primaryProgress,
      :host(.transiting) #secondaryProgress{-webkit-transition-property:-webkit-transform;transition-property:transform;-webkit-transition-duration:var(--paper-progress-transition-duration, 0.08s);transition-duration:var(--paper-progress-transition-duration, 0.08s);-webkit-transition-timing-function:var(--paper-progress-transition-timing-function, ease);transition-timing-function:var(--paper-progress-transition-timing-function, ease);-webkit-transition-delay:var(--paper-progress-transition-delay, 0s);transition-delay:var(--paper-progress-transition-delay, 0s);}#primaryProgress,
      #secondaryProgress{@apply (--layout-fit);-webkit-transform-origin:left center;transform-origin:left center;-webkit-transform:scaleX(0);transform:scaleX(0);will-change:transform;}#primaryProgress{background:var(--paper-progress-active-color, --google-green-500);}#secondaryProgress{background:var(--paper-progress-secondary-color, --google-green-100);}:host([disabled]) #primaryProgress{background:var(--paper-progress-disabled-active-color, --google-grey-500);}:host([disabled]) #secondaryProgress{background:var(--paper-progress-disabled-secondary-color, --google-grey-300);}:host(:not([disabled])) #primaryProgress.indeterminate{-webkit-transform-origin:right center;transform-origin:right center;-webkit-animation:indeterminate-bar var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;animation:indeterminate-bar var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;}:host(:not([disabled])) #primaryProgress.indeterminate::after{content:"";-webkit-transform-origin:center center;transform-origin:center center;-webkit-animation:indeterminate-splitter var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;animation:indeterminate-splitter var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;}@-webkit-keyframes indeterminate-bar{0%{-webkit-transform:scaleX(1) translateX(-100%);}50%{-webkit-transform:scaleX(1) translateX(0%);}75%{-webkit-transform:scaleX(1) translateX(0%);-webkit-animation-timing-function:cubic-bezier(.28,.62,.37,.91);}100%{-webkit-transform:scaleX(0) translateX(0%);}}@-webkit-keyframes indeterminate-splitter{0%{-webkit-transform:scaleX(.75) translateX(-125%);}30%{-webkit-transform:scaleX(.75) translateX(-125%);-webkit-animation-timing-function:cubic-bezier(.42,0,.6,.8);}90%{-webkit-transform:scaleX(.75) translateX(125%);}100%{-webkit-transform:scaleX(.75) translateX(125%);}}@keyframes indeterminate-bar{0%{transform:scaleX(1) translateX(-100%);}50%{transform:scaleX(1) translateX(0%);}75%{transform:scaleX(1) translateX(0%);animation-timing-function:cubic-bezier(.28,.62,.37,.91);}100%{transform:scaleX(0) translateX(0%);}}@keyframes indeterminate-splitter{0%{transform:scaleX(.75) translateX(-125%);}30%{transform:scaleX(.75) translateX(-125%);animation-timing-function:cubic-bezier(.42,0,.6,.8);}90%{transform:scaleX(.75) translateX(125%);}100%{transform:scaleX(.75) translateX(125%);}}</style><div id="progressContainer"><div id="secondaryProgress" hidden$="[[_hideSecondaryProgress(secondaryRatio)]]"></div><div id="primaryProgress"></div></div></template></dom-module><script>Polymer({is:'paper-progress',behaviors:[Polymer.IronRangeBehavior],properties:{secondaryProgress:{type:Number,value:0},secondaryRatio:{type:Number,value:0,readOnly:!0},indeterminate:{type:Boolean,value:!1,observer:'_toggleIndeterminate'},disabled:{type:Boolean,value:!1,reflectToAttribute:!0,observer:'_disabledChanged'}},observers:['_progressChanged(secondaryProgress, value, min, max)'],hostAttributes:{role:'progressbar'},_toggleIndeterminate:function(b){this.toggleClass('indeterminate',b,this.$.primaryProgress)},_transformProgress:function(b,c){b.style.transform=b.style.webkitTransform='scaleX('+c/100+')'},_mainRatioChanged:function(b){this._transformProgress(this.$.primaryProgress,b)},_progressChanged:function(b,c,d,e){b=this._clampValue(b),c=this._clampValue(c);var f=100*this._calcRatio(b),g=100*this._calcRatio(c);this._setSecondaryRatio(f),this._transformProgress(this.$.secondaryProgress,f),this._transformProgress(this.$.primaryProgress,g),this.secondaryProgress=b,this.setAttribute('aria-valuenow',c),this.setAttribute('aria-valuemin',d),this.setAttribute('aria-valuemax',e)},_disabledChanged:function(b){this.setAttribute('aria-disabled',b?'true':'false')},_hideSecondaryProgress:function(b){return 0===b}});</script></div><dom-module id="shop-addevent"><template><style include="shop-common-styles shop-button shop-form-styles shop-input shop-select shop-checkbox">.main-frame{transition:opacity 0.5s;}:host([waiting]) .main-frame{opacity:0.1;}paper-icon-button{color:var(--app-primary-color);}.logo{text-align:center;}.logo a{font-size:20px;font-weight:600;letter-spacing:0.3em;color:var(--app-white-color);text-decoration:none;display:inline-block;pointer-events:auto;}.left-bar-item{width:40px;}app-header{@apply (--layout-fixed-top);z-index:1;background-color:#1976D2;--app-header-shadow:{box-shadow:inset 0px 5px 6px -3px rgba(0, 0, 0, 0.2);height:10px;bottom:-10px;};}shop-input, shop-select{font-size:16px;}shop-select{margin-bottom:20px;}paper-spinner-lite{position:fixed;top:calc(50% - 14px);left:calc(50% - 14px);}progress{width:100%;margin-bottom:5px;-webkit-appearance:none;appearance:none;}.grid{margin-top:40px;@apply (--layout-horizontal);}.grid > section{@apply (--layout-flex);}.grid > section:not(:first-child){margin-left:80px;}.row{@apply (--layout-horizontal);@apply (--layout-end);}.column{@apply (--layout-vertical);}.fullwidth{width:100%;}.row > .flex,
      .input-row > *{@apply (--layout-flex);}.input-row > *:not(:first-child){margin-left:8px;}.shop-select-label{line-height:20px;}.order-summary-row{line-height:24px;}.total-row{font-weight:500;margin:30px 0;}@media (max-width: 767px){.grid{display:block;margin-top:0;}.grid > section:not(:first-child){margin-left:0;}}.enabled{border:1px solid #555;@apply (--file-upload-upload-border-enabled);}.hover{opacity:.7;border:1px dashed #111;@apply (--file-upload-upload-border-hover);}#UploadBorder{vertical-align:middle;color:#555;padding-top:20px;padding-bottom:20px;max-height:300px;width:100%;overflow-y:auto;margin-top:15px;display:inline-block;@apply (--file-upload-upload-border);}#dropArea{text-align:center;@apply (--file-upload-drop-area);}paper-button#button{margin-bottom:20px;@apply (--file-upload-button);}paper-button#button:hover{@apply (--file-upload-button-hover);}.file{padding:10px 0px;margin-left:15px;@apply (--file-upload-file);}.commands{float:right;margin-right:10px;@apply (--file-upload-commands);}.commands iron-icon:not([icon="check-circle"]){cursor:pointer;opacity:.9;@apply (--file-upload-commands-faded);}.commands iron-icon:hover{opacity:1;@apply (--file-upload-commands-hovered);}[hidden]{display:none;}.error{color:var(--error-color);font-size:11px;margin-top:2px;@apply (--file-upload-error);}.progress-bar{margin-top:2px;}paper-progress{--paper-progress-active-color:#03a9f4;}paper-progress[error]{--paper-progress-active-color:var(--error-color);}</style><firebase-auth id="auth" provider="email" signed-in="{{signedIn}}" user="{{user}}" on-error="handleError"></firebase-auth><firebase-document path="/users/[[user.uid]]" data="{{userprofile}}"></firebase-document><app-header role="navigation" id="header" effects="waterfall" hidden="[[!signedin]]" condenses="" reveals=""><app-toolbar><div class="left-bar-item"><paper-icon-button class="menu-btn" icon="menu" on-click="_toggleDrawer" aria-label="Categories"></paper-icon-button></div><div class="logo" main-title=""><a href="#/" aria-label="SHOP Home">PROJECTAGRAM</a></div></app-toolbar></app-header><div class="main-frame"><iron-pages selected="[[state]]" attr-for-selected="state"><div state="init"><form id="checkoutForm" is="iron-form" method="post" action="/data/sample_success_response.json" on-iron-form-response="_didReceiveResponse" on-iron-form-presubmit="_willSendRequest"><header class="subsection" visible$="{{hideFileListRe}}"><h1>Add Event</h1><span>Please fill all the details of the event...!!!!</span></header><div class="subsection grid" visible$="{{hideFileListRe}}"><section><h2 id="accountInfoHeading">Event Information</h2><div class="row input-row"><shop-input><input type="date" id="date" name="date" placeholder="Event Date" required="" aria-labelledby="dateLabel accountInfoHeading"><shop-md-decorator error-message="Invalid Date" aria-hidden="true"><label id="dateLabel">Date Of Event</label><shop-underline></shop-underline></shop-md-decorator></shop-input></div><div class="row input-row"><shop-input><input type="text" id="eventTitle" name="eventTitle" placeholder="Event Title" pattern="[0-9A-Za-z].{6,}" required="" aria-labelledby="eventTitleLabel accountInfoHeading"><shop-md-decorator error-message="More than 6 characters" aria-hidden="true"><label id="eventTitleLabel">Event Title</label><shop-underline></shop-underline></shop-md-decorator></shop-input></div><div class="row input-row"><shop-input><input type="text" id="eventDes" name="eventDes" pattern=".{5,}" placeholder="Phone Number" required="" aria-labelledby="accountPhoneLabel accountInfoHeading"><shop-md-decorator error-message="More than 5 characters" aria-hidden="true"><label id="accountPhoneLabel">Event Description</label><shop-underline></shop-underline></shop-md-decorator></shop-input></div><div class="row input-row"><div class="column"><label for="location">Location</label><shop-select><select id="location" name="location" required="" autocomplete="location" aria-label="Location"><option value="Mumbai" selected="">Mumbai</option><option value="Gurgaon">Gurgaon</option><option value="Bangalore">Bangalore</option><option value="Hyderabad">Hyderabad</option><option value="US">US</option></select><shop-md-decorator aria-hidden="true"><shop-underline></shop-underline></shop-md-decorator></shop-select></div></div></section><section><h2 id="otherInfoHeading">Upload Photos</h2><div class="row input-row"><shop-input><shop-button fullwidth="" id="button"><input class="fullwidth" type="button" id="button" on-click="_fileClick" value="Select Photos"></shop-button><div id="UploadBorder" hidden$="{{hideFileList}}"><div id="dropArea" hidden$="{{!_shownDropText}}">{{dropText}}</div><template is="dom-repeat" items="{{files}}"><div class="file"><div class="name"><span>{{item.name}}</span><div class="commands"><iron-icon icon="file-upload-icons:autorenew" title="{{retryText}}" on-click="_retryUpload" hidden$="{{!item.error}}"></iron-icon><iron-icon icon="file-upload-icons:cancel" title="{{removeText}}" on-click="_cancelUpload" hidden$="{{item.complete}}"></iron-icon><iron-icon icon="file-upload-icons:check-circle" title="{{successText}}" hidden$="{{!item.complete}}"></iron-icon></div></div><div class="error" hidden$="{{!item.error}}">{{errorText}}</div><div class="progress-bar" hidden$="{{progressHidden}}"><paper-progress value$="{{item.progress}}" error$="{{item.error}}"></paper-progress></div></div></template></div><input type="file" id="fileInput" on-change="_fileChange" hidden="" multiple="{{multi}}" accept="{{accept}}" required="" placeholder="Select Photos"></shop-input></div></section></div><shop-button fullwidth="" responsive="" id="submitBox"><input class="fullwidth" type="button" on-click="_submit" value="ADD EVENT"></shop-button></form></div><header state="success"><h1>Thank you</h1><p>[[response.successMessage]]</p><shop-button responsive=""><a href="#/home">Go to Home</a></shop-button></header><header state="error"><h1>We couldn´t add the user at this moment.</h1><p id="errorMessage">[[response.errorMessage]]</p><shop-button responsive=""><a href="#/adduser">Try again</a></shop-button></header></iron-pages></div><app-route route="[[route]]" pattern="/:state" on-active-changed="_activeRouteHandler"></app-route><paper-spinner-lite active="[[waiting]]"></paper-spinner-lite></template><script>Polymer({is:'shop-addevent',properties:{route:{type:Object,notify:!0},userprofile:Object,uploadedcnt:Number,state:{type:String,value:'init'},response:Object,visible:{type:Boolean,observer:'_visibleChanged'},fileType:{type:String,value:'image/jpeg'},waiting:{type:Boolean,readOnly:!0,reflectToAttribute:!0},accept:{type:String,value:'image/jpeg'},hideFileList:{type:Boolean,value:!1},hideFileListRe:{type:Boolean,value:!0},progressHidden:{type:Boolean,value:!1},droppable:{type:Boolean,value:!0},dropText:{type:String,value:'Drop Files Here(<= 10MB)'},multi:{type:Boolean,value:!0},files:{type:Array,notify:!0,value:function(){return[]}},raised:{type:Boolean,value:!0},noink:{type:Boolean,value:!1},retryText:{type:String,value:'Retry Upload'},removeText:{type:String,value:'Remove'},successText:{type:String,value:'Success'},errorText:{type:String,value:'Error uploading file...'},_shownDropText:{type:Boolean,value:!1},additional:{type:Object,value:{}},manualUpload:{type:Boolean,value:!0},fileDataName:{type:String,value:'file'},paperButtonAlt:{type:String,value:''},paperButtonTitle:{type:String,value:''},user:Object},_toggleDrawer:function(){this.fire('toggle-drawer',null)},_submit:function(){if(this._validateForm()){this.$.checkoutForm.fire('iron-form-presubmit',null,{bubbles:!1});var c=this.$.auth.app,d=-1*Date.now(),f=this.files[0],g={author:this.userprofile.name,uid:this.user.uid,description:this.$.eventDes.value,title:this.$.eventTitle.value,date:this.$.date.value,firstimage:f.name,_timestamp:d},h=c.database().ref().child('posts').push().key,j={};if(j['/posts/'+h]=g,j['/user-posts/'+this.user.uid+'/'+h]=g,c.database().ref().update(j),this.files){var k=this.files.length;this.uploadedcnt=0;for(var f,l=0;l<k;l++)f=this.files[l],this.uploadFileToServerTest(f,h)}}},_pushState:function(b){this._validState=b,this.set('route.path',b);Polymer.AppLayout.scroll({top:0,behavior:'silent'})},_activeRouteHandler:function(b){var c=b.target;if(b.detail.value){var d=c.data.state;if(this._validState===d)return this.state=d,void(this._validState='')}this.state='init'},_reset:function(){var b=this.$.checkoutForm;this._setWaiting(!1),b.reset(),this.set('files',[]),this.$.fileInput.value='',this._showDropText(),this.uploadedcnt=0;for(var c,d=0;c=b.elements[d],d<b.elements.length;d++)c.removeAttribute('aria-invalid')},_validateForm:function(){for(var d,b=this.$.checkoutForm,c=!1,f=0;d=b.elements[f],f<b.elements.length;f++)d.checkValidity()?d.removeAttribute('aria-invalid'):(c||(d.nextElementSibling&&this.fire('announce',d.nextElementSibling.getAttribute('error-message')),d.scrollIntoViewIfNeeded?d.scrollIntoViewIfNeeded():d.scrollIntoView(!1),d.focus(),c=!0),d.setAttribute('aria-invalid','true'));return!c},_willSendRequest:function(b){var c=b.target,d=c.request.body;this._setWaiting(!0)},_didReceiveResponse:function(b){var c=b.detail.response;this.response=c,this._setWaiting(!0),c.success?(this._pushState('success'),this._reset()):(this._pushState('error'),this._reset())},_computeHasItemRe:function(){return!0},_visibleChanged:function(b){b&&(this._reset(),this.fire('change-section',{title:'Add Event'}))},_toArray:function(b){return Object.keys(b).map(function(c){return{name:c,value:b[c]}})},target:{type:String,value:''},clear:function(){this.set('files',[]),this.$.fileInput.value='',this._showDropText()},ready:function(){this.raised&&this.toggleAttribute('raised',!0,this.$.button),this.noink&&this.toggleAttribute('noink',!0,this.$.button),this.droppable&&(this._showDropText(),this.setupDrop())},setupDrop:function(){var b=this.$.UploadBorder;this.toggleClass('enabled',!0,b),this.ondragover=function(c){c.stopPropagation(),this.toggleClass('hover',!0,b);var d=c.dataTransfer&&c.dataTransfer.dropEffect,f=c.dataTransfer&&c.dataTransfer.effectAllowed;return'none'===d&&'none'!==f&&(c.dataTransfer.dropEffect='move'===f?'move':'copy'),!1},this.ondragleave=function(){return this.toggleClass('hover',!1,b),!1},this.ondrop=function(c){if(this.toggleClass('hover',!1,b),c.preventDefault(),this.multi||0===this.files.length)for(var d=c.dataTransfer.files.length,f=0;f<d;f++){var g=c.dataTransfer.files[f],h=''===g.type?null:g.type.match(/^[^\/]*\//)[0],j=g.name.match(/\.[^\.]*$/)[0],k=g.size/1024/1024;(''===this.accept||!(10<k)||-1<this.accept.indexOf(h)||-1<this.accept.indexOf(j))&&(g.progress=0,g.error=!1,g.complete=!1,this.push('files',g),this.manualUpload||this.uploadFile(g))}}},_fileClick:function(){var b=this.$.fileInput;if(b&&document.createEvent){var c=document.createEvent('MouseEvents');c.initEvent('click',!0,!1),b.dispatchEvent(c)}},_fileChange:function(b){for(var c=b.target.files.length,d=0;d<c;d++){var f=b.target.files[d],g=f.size/1024/1024;10<g||(f.progress=0,f.error=!1,f.complete=!1,this.multi?this.push('files',f):this.set('files',[f]))}},_manualUpload:function(){if(this.files)for(var f,c=this.files.length,d=0;d<c;d++)f=this.files[d],this.uploadFile(f)},cancel:function(b){if(b){var c=this.$.auth.app,d='';d='posts/'+b.name;var f=c.storage().ref(d),g=f.put(b);g.cancel(),this.splice('files',this.files.indexOf(b),1),this._showDropText()}},_cancelUpload:function(b){this.cancel(b.model.__data__.item)},_retryUpload:function(b){b.model.set('item.error',!1),b.model.set('item.progress',0);var c=this;this.async(function(){c.uploadFile(b.model.__data__.item)},50)},_showDropText:function(){this.set('_shownDropText',!this.files.length&&this.droppable)},uploadFile:function(b){if(b){this.fire('before-upload'),this._showDropText();var c='files.'+this.files.indexOf(b),d=this,f=this.$.auth.app,g='';g='posts/'+b.name;var h=f.storage().ref(g),j=h.put(b);j.on('state_changed',function(l){var m=100*(l.bytesTransferred/l.totalBytes);d.set(c+'.progress',m)},function(){d.set(c+'.error',!0),d.set(c+'.complete',!1),d.set(c+'.progress',100),d.updateStyles()},function(){d.set(c+'.complete',!0)})}},uploadFileToServerTest:function(b,c){if(b){var d=this,f=this;this.resizeImage({file:b,maxSize:1200}).then(function(g){d.fire('before-upload'),d._showDropText();var h='files.'+d.files.indexOf(b),j=d.$.auth.app,k='';k='posts/'+c+'/'+b.name;var l=j.storage().ref(k),m=l.put(g);m.on('state_changed',function(o){var p=100*(o.bytesTransferred/o.totalBytes);f.set(h+'.progress',p)},function(){f.set(h+'.error',!0),f.set(h+'.complete',!1),f.set(h+'.progress',100),f.updateStyles()},function(){f.set(h+'.complete',!0);var o=d.$.auth.app,p=b.name;p=p.replace(/\.[^/.]+$/,''),o.database().ref().child('posts/'+c+'/images/'+p).set(b.name),o.database().ref().child('/user-posts/'+d.user.uid+'/'+c+'/images/'+p).set(b.name),++d.uploadedcnt;var q=d.files.length;q==d.uploadedcnt&&d.debounce('_submitForm',function(){d.$.checkoutForm.fire('iron-form-response',{response:{success:1,successMessage:'Event Added Successfully..!!'}},{bubbles:!1})},1e3)})}).catch(function(){})}},resizeImage:function(b){var c=b.file,d=b.maxSize,f=new FileReader,g=new Image,h=document.createElement('canvas'),j=function(m){for(var n=0<=m.split(',')[0].indexOf('base64')?atob(m.split(',')[1]):unescape(m.split(',')[1]),o=m.split(',')[0].split(':')[1].split(';')[0],p=n.length,q=new Uint8Array(p),r=0;r<p;r++)q[r]=n.charCodeAt(r);return new Blob([q],{type:o})},k=function(){var m=g.width,n=g.height;m>n?m>d&&(n*=d/m,m=d):n>d&&(m*=d/n,n=d),h.width=m,h.height=n,h.getContext('2d').drawImage(g,0,0,m,n);var o=h.toDataURL('image/jpeg');return j(o)};return new Promise(function(l,m){return c.type.match(/image.*/)?void(f.onload=function(n){g.onload=function(){return l(k())},g.src=n.target.result},f.readAsDataURL(c)):void m(new Error('Not an image'))})}});</script></dom-module></body></html>